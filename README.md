**Лабораторная работа №1. Управление файлами и каталогами** 

**Задачи:** 

1. Освоить основные команды для работы с файлами и каталогами (директориями). 
1. Научиться использовать справочную информацию по командам. 

**Подсказки:** 

1. При выполнении работы могут использоваться следующие команды:  cat; cd; chmod, cmp; cp; diff; find; head; less; ln; ls; man; mkdir; mv; nano; patch; rm; split; vi; wc. 
1. Для получения подробного справочного руководства по любой команде можно набрать в «man  название команды», для кратной справки – название_команды --help. 
1. По умолчанию, команды выводят результаты работы в консоль. Для перенаправления стандартного вывода с консоли в файл можно использовать операторы  «>» или «>>». 
1. Команды могут быть собраны в конвейеры с помощью оператора «|». 
1. Для удобства работы можно пользоваться одновременно несколькими консолями. На одной консоли читать справочное руководство, на другой редактировать скрипт и т.п. Переключаться между ними можно нажатием комбинации клавиш Alt+Fn, где Fn — функциональная клавиша (F1 — для первой консоли, F2 - для второй и т.д.). 
1. Для того чтобы было удобнее смотреть результаты выполнения тех команд, которые что-то выводят на экран можно после них вставлять в скрипт паузу (с помощью команды sleep) или ожидать нажатия Enter с помощью команды read. 

**Задание:** 

Создать скрипт (создать текстовый файл с необходимыми командами (добавив в начало #!/bin/sh), сделать его исполняемым). Создать и редактировать скрипт можно в редакторах nano или vi. 

Скрипт должен выполнять следующие действия: 

1. Создать каталог test в домашнем каталоге пользователя. 
1. Создать в нем файл list, содержащий список всех файлов и поддиректориев каталога /etc (включая скрытые) в таком виде, что можно однозначно определить какая из записей является именем файла, а какая — названием директории. 
1. Вывести в конец этого файла два числа. Сначала количество поддиректориев в каталоге /etc, а затем количество скрытых файлов в каталоге /etc. 
1. Создать в каталоге test каталог links. 
1. Создать в каталоге links жесткую ссылку на файл list с именем list_hlink. 
1. Создать в каталоге links символическую ссылку на файл list с именем list_slink. 
1. Вывести на экран количество имен (жестких ссылок) файла list_hlink, количество имен (жестких ссылок) файла list и количество имен (жестких ссылок) файла list_slink. 
1. Дописать в конец файла list_hlink число строк в файле list.  
1. Сравнить содержимое файлов list_hlink и list_slink. Вывести на экран YES, если файлы идентичны. 
1. Переименовать файл list в list1. 
1. Сравнить содержимое файлов list_hlink и list_slink. Вывести на экран YES, если файлы идентичны. 
1. Создать в домашнем каталоге пользователя жесткую ссылку на файл list_link с именем list1. 
1. Создать в домашнем каталоге файл list_conf, содержащий список файлов с расширением .conf, из каталога /etc и всех его подкаталогов. 
1. Создать в домашнем каталоге файл list_d, содержащий список всех подкаталогов каталога /etc, расширение которых .d. 
1. Создать файл list_conf_d, включив в него последовательно содержимое list_conf и list_d. 
1. Создать в каталоге test скрытый каталог sub. 
1. Скопировать в него файл list_conf_d. 
1. Еще раз скопировать туда же этот же файл в режиме автоматического создания резервной копии замещаемых файлов. 
1. Вывести на экран полный список файлов (включая все подкаталоги и их содержимое) каталога test. 
1. Создать в домашнем каталоге файл man.txt, содержащий документацию на команду man. 
21. Разбить файл man.txt на несколько файлов, каждый из которых будет иметь размер не более 1 килобайта. 
21. Создать каталог man.dir. 
21. Переместить одной командой все файлы, полученные в пункте 21 в каталог man.dir. 
21. Собрать файлы в каталоге man.dir обратно в файл с именем man.txt. 
21. Сравнить файлы man.txt в домашней каталоге и в каталоге man.dir и вывести YES, если файлы идентичны. 
21. Добавить в файл man.txt, находящийся в домашнем каталоге несколько строчек с произвольными символами в начало файла и несколько строчек в конце файла. 
21. Одной командой получить разницу между файлами в отдельный файл в стандартном формате для наложения патчей. 
21. Переместить файл с разницей в каталог man.dir. 
21. Наложить патч из файла с разницей на man.txt в каталоге man.dir. 
21. Сравнить файлы man.txt в домашней каталоге и в каталоге man.dir и вывести YES, если файлы идентичны. 

Предъявить скрипт преподавателю и ответить на его вопросы по любым использованным командам и выполняющимся операциям. Перед сдачей лабораторной работы подумать, как объяснить результаты выполнения пунктов 7, 9, 11, 25, 30 

**Лабораторная работа №2**

**Управление разделами дисковой системы, создание и монтирование файловых систем** 

**Задачи:**  

1) Научиться создавать, изменять и удалять разделы на жестких дисках. 
1) Научиться создавать и настраивать файловые системы. 
1) Научиться монтировать файловые системы, находящиеся в локальном или сетевом доступе. **Подсказки:**  
1) В работе используются следующие команды (в дополнение к изученным в предыдущих лабораторных работах): blkid, dumpe2fs, e2fsck, fdisk, lvcreate, mke2fs, mkfs.ext4, mount, mount.cifs, pvcreate, resize2fs, reboot, tune2fs, umount, vgcreate. 
1) Прочитайте документацию по указанным командам и определите их назначение до начала выполнения заданий. 
1) Параметры автоматического монтирования файловых систем при загрузке операционной системы задаются в конфигурационном файле /etc/fstab. 
1) Для получения подробного справочного руководства по любой команде можно набрать в консоли «man  название команды», для кратной справки — название_команды -h или название_команды --help.  
5) Для удобства работы можно пользоваться одновременно несколькими консолями. На одной консоли читать справочное руководство, на другой редактировать скрипт и т.п. Переключаться между ними можно нажатием комбинации клавиш Alt+Fn, где Fn — функциональная клавиша (F1 — для первой консоли, F2 — для второй, а вот 7-я консоль обычно занята графическим интерфейсом).  

**Задание:**  

ВНИМАНИЕ! Перед началом работы создайте снимок виртуальной машины. Рекомендуется делать снимки также перед выполнением пунктов 10 и 12 и 13. 

Создайте текстовый файл в котором запишите последовательность команд для выполнения каждого из нижеследующих заданий. Для команд, имеющих интерактивный интерфейс – опишите последовательность выбора управляющих команд и их параметров. Если решение заключается в изменении конфигурационного файла – укажите название файла и вносимые или изменяемые строки. 

Требуемые действия. 

1. Создайте новый раздел, начинающийся с первого свободного сектора и имеющий размер 300 МБайт. 
1. Создайте файл в домашнем каталоге пользователя root и сохраните в него UUID созданного раздела. 
1. Создайте на созданном разделе файловую систему ext4 с размером блока 4096 байт. 
1. Выведите на экран текущее состояние параметров, записанных в суперблоке созданной файловой системы. 
1. Настройте эту файловую систему таким образом, чтобы ее автоматическая проверка запускалась через 2 месяца или каждое второе монтирование файловой системы. 
1. Создайте в каталоге /mnt подкаталог newdisk и подмонтируйте в него созданную файловую систему. 
1. Создайте в домашнем каталоге пользователя root ссылку на смонтированную файловую систему 
1. Создайте каталог с любым именем в смонтированной файловой системе. 
1. Включите автомонтирование при запуске операционной системы созданной файловой системы в /mnt/newdisk таким образом, чтобы было невозможно запускать исполняемые файлы, находящиеся в этой системе, а также с отключением возможности записи времени последнего доступа к файлу для ускорения работы с этой файловой системой. Перезагрузите операционную систему и проверьте доступность файловой системы. Проверьте невозможность запустить исполняемый файл, если он хранится в этой файловой системе. 
1. Увеличьте размер раздела и файловой системы до 350 МБайт. Проверьте, что размер изменился. 
1. Проверьте на наличие ошибок созданную файловую системы "в безопасном режиме", то есть в режиме запрета внесения каких-либо изменений в файловую систему, даже если обнаружены ошибки. 
12. Создайте новый раздел, размером в 12 Мбайт. Настройте файловую систему, созданную в пункте 3 таким образом, чтобы ее журнал был расположен на разделе, созданном в этом пункте. 
12. Создайте два новых раздела, размером в 100 МБайт каждый. 
12. Создайте группу разделов LVM и логический том LVM над созданными в предыдущем пункте разделами. Создайте файловую систему ext4 для созданного логического тома LVM и смонтируйте её в предварительно созданный каталог supernewdisk в каталоге mnt. 
12. Создайте папку (каталог) в хостовой операционной системе и предоставьте к ней сетевой доступ, создав сетевой ресурс на хостовой операционной системе. Создайте в директории /mnt поддиректорию share и подмонтируйте в нее созданный сетевой ресурс. 
12. Сделайте так, чтобы сетевой ресурс автоматически монтировалcя для чтения при загрузке операционной системы. Перезагрузите операционную систему и проверьте, что автоматическое монтирование ресурса выполнилось. 

**Лабораторная работа №3**  
**Управление пользователями, группами пользователей и правами на файлы и каталоги в Linux** 

**Задачи**  

1) Научиться создавать, изменять и редактировать учетные записи пользователей и групп пользователей в Linux.  
1) научиться задавать атрибуты прав и владения для файлов и каталогов под конкретные задачи 

**Подсказки**  

1) В работе используются следующие команды (в дополнение к изученным в предыдущих лабораторных работах): **groupadd, useradd, groupdel, userdel, groupmod,  usermod, openssl, chage, chmod, chgrp, chown, groups, id.** 
1) Сведения о пользователях системы и их идентификаторах (UID) хранятся в файле **/etc/passwd** 
1) Для вывода результата работы команды или конвейера команд в новый файл используется конструкция: **command > file** 
1) Для добавления результатов работы команды или конвейера команд в конец существующего файла используется конструкция: **command >> file** 
1) Директория **/etc/skel** содержит копии различных установочных и других файлов, которые могут быть скопированы в новые домашние директории пользователей, когда программа **useradd** добавляет нового пользователя. 
1) Для шифрования пароля можно использовать команду **openssl passwd –crypt незашифрованный_пароль**. Для того чтобы результат выполнения команды **command2** подставить в значение параметра **p** команды **command1** можно использовать конструкцию: **command1 –p $(command2)** 
1) Для получения подробного справочного руководства по любой команде можно набрать в консоли «**man название команды**».  
1) Для удобства работы можно пользоваться одновременно несколькими консолями. На одной консоли читать справочное руководство, на другой редактировать скрипт и т.п. Переключаться между ними можно нажатием комбинации клавиш Ctrl+Alt+Fn, где Fn – функциональная клавиша (F1 – для первой консоли, F2 – для второй, а вот 7-я консоль обычно занята графическим интерфейсом).  

**Задание**  

Создать скрипт, который:  

1) выводит в файл **work3.log** построчно список всех пользователей в системе в следующем формате: «**user NNN has id MM**»; 
1) добавляет в файл **work3.log** строку, содержащую дату последней смены пароля для пользователя **root**; 
1) добавляет в файл **work3.log** список всех групп в системе (только названия групп) через запятую; 
1) делает так, чтобы при создании нового пользователя у него в домашнем каталоге создавался файл **readme.txt** с текстом «**Be careful**!»; 
1) создает пользователя **u1** с паролем **12345678**; 
1) создает группу **g1**; 
1) делает так, чтобы пользователь **u1** дополнительно входил в группу **g1**; 
1) добавляет в файл **work3.log** строку, содержащую сведения об идентификаторе и имени пользователя **u1** и идентификаторах и именах всех групп, в которые он входит; 
9) делает так, чтобы пользователь **user** дополнительно входил в группу **g1** 
9) добавляет в файл **work3.log** строку с перечнем пользователей в группе **g1** через запятую; 
9) делает так, что при входе пользователя **u1** в систему вместо оболочки **bash** автоматически запускается **/usr/bin/mc**, при выходе из которого пользователь возвращается к вводу логина и пароля; 
9) создает пользователя **u2** с паролем **87654321**; 
9) в каталоге **/home** создает каталог **test13,** в который копирует файл **work3.log** два раза с разными именами (**work3-1.log** и **work3-2.log**); 
9) сделает так, чтобы пользователи **u1** и **u2** смогли бы просматривать каталог **test13** и читать эти файлы, только пользователь **u1** смог бы изменять и удалять их, а все остальные пользователи системы не могли просматривать содержимое каталога **test13** и файлов в нем. При этом никто не должен иметь права исполнять эти файлы; 
9) создает в каталоге **/home** каталог **test14,** в который любой пользователь системы сможет записать данные, но удалить любой файл сможет только пользователь, который его создал или пользователь **u1**; 
9) копирует в каталог **test14** исполняемый файл редактора **nano** и делает так, чтобы любой пользователь смог изменять с его помощью файлы, созданные в пункте 13; 
9) создает каталог test15 и создает в нем текстовый файл /test15/secret_file. Делает так, чтобы содержимое этого файла можно было вывести на экран, используя полный путь, но чтобы узнать имя этого файла, было бы невозможно. 

Отдельно создать второй скрипт, который полностью уничтожает результаты деятельности предыдущего: удаляет созданных пользователей и их домашние каталоги, удаляет созданные группы, удаляет все созданные в предыдущем скрипте файлы и каталоги. 

**Лабораторная работа №4. Установка программного обеспечения** 

**Задачи:**  

1. Научиться получать информацию об установленных и доступных пакетах и устанавливать пакеты программного обеспечения из репозиториев в Linux. 
1. Научиться устанавливать программные продукты из исходных кодов в Linux. 
1. Научится конфигурировать менеджер пакетов и создавать собственные репозитории. 

**Рекомендации:**  

1. Программные продукты под Linux распространяются или в виде готовых бинарных пакетов (с расширением deb для ветви Debian и расширением rpm для ветви RedHat) или в виде исходных кодов. 
1. Из бинарного пакета программное обеспечение устанавливается с помощью специального ПО — менеджера пакетов (например, dpkg и apt для Debian ветви и rpm или dnf (в ранних версиях yum) для ветви RedHat). Менеджеры пакетов также позволяют работать с репозиториями — коллекциями пакетов, некоторые из которых поддерживаются производителями дистрибутивов. На работу с такими репозиториями, как правило, по умолчанию настроена система.  
1. Для установки, обновления и просмотра информации о пакетах из сетевого репозитория используется менеджер пакетов **dnf**. 
1. Исходный код программ, в большинстве случаев, распространяется в архивах. Для создания этих архивов, как правило, используются две программы: **tar** и **gzip**. Первая собирает все исходные файлы, включая структуру каталогов в один общий файл, а вторая сжимает этот файл для того, чтобы сэкономить время передачи архива по сети. 
1. Сборка и установка пакетов из исходных кодов осуществляется с помощью последовательного запуска команд: 

        make

        make install 

Эти команды должны быть запущены так, чтобы текущим каталогом при этом был каталог с исходным кодом устанавливаемого пакета, содержащий файл с именем **Makefile**. 

6. Для создания собственного репозитория должен быть установлен и использован пакет **createrepo**.  
6. Для каждого репозитория в системе должен быть конфигурационный файл. Эти файлы располагаются в каталоге: **/etc/yum.repos.d**. Файл обязан иметь расширение **.repo**. Файл имеет следующую структуру (курсивом отмечены изменяемые значения): 

    **[*название_репозитория*]** 

    **name=*название_репозитория*** 

    **mirrorlist=*список_адресов_репозитория*** 

    **enabled=*значение_флага_доступности* gpgcheck=*значение_флага_проверки_цифровой_подписи*** 

Примечания: Если репозиторий находится в локальном доступе, то в качестве адреса указывается: **file://полный_путь_к_каталогу/** 

Если пакеты получены из надежных источников, значение флага проверки цифровой подписи можно поставить равное 0 и не настраивать проверку ключей. 

8. В случае необходимости установить приложение, существующее в виде пакета Debian, необходимо воспользоваться утилитой **alien**. Если её нет в стандартном репозитории, можно найти репозиторий, содержащий эту утилиту или установить её из исходного кода. 

**Задание:** 

Выполните указанные ниже действия и запишите все использовавшиеся команды с параметрами и изменения в файлах в отдельный файл: 

1. Установите из сетевого репозитория пакеты, входящие в группу «Developments Tools». 
1. Установите из исходных кодов, приложенных к методическим указаниям пакет **bastet-0.43**. Для этого необходимо создать отдельный каталог и скопировать в него исходные коды проекта **bastet**. Вы можете использовать подключение сетевого каталога в хостовой операционной системе для передачи архива с исходными кодами в виртуальную машину. Далее следует распаковать архив до появления каталога с исходными файлами (в каталоге должен отображаться **Makefile**). После этого соберите пакет **bastet** и запустите его, чтобы удостовериться, что он правильно собрался. Затем модифицируйте Makefile, добавив в него раздел install. Обеспечьте при установке копирование исполняемого файла в /usr/bin с установкой соответствующих прав доступа. Выполните установку и проверьте, что любой пользователь может запустить установленный пакет. 
3. Создайте файл **task3.log**, в который выведите список всех установленных пакетов. 
3. Создайте файл **task4_1.log**, в который выведите список всех пакетов (зависимостей), необходимых для установки и работы компилятора **gcc**. Создайте файл **task4_2.log**, в который выведите список всех пакетов (зависимостей), установка которых требует установленного пакета **libgcc**. 
3. Создайте каталог **localrepo** в домашнем каталоге пользователя root и скопируйте в него пакет **checkinstall-1.6.2-3.el6.1.x86_64.rpm** , приложенный к методическим указаниям. Создайте собственный локальный репозиторий с именем localrepo из получившегося каталога с пакетом. 
3. Создайте файл **task6.log**, в который выведите список всех доступных репозиториев. 
3. Настройте систему на работу только с созданным локальным репозиторием (достаточно переименовать конфигурационные файлы других репозиториев). Выведите на экран список доступных для установки пакетов и убедитесь, что доступен только один пакет, находящийся в локальном репозитории. Установите этот пакет. 
3. Скопируйте в домашний каталог пакет **fortunes-ru_1.52-2_all**, приложенный к методическим рекомендациям, преобразуйте его в rpm пакет и установите. 
3. Скачайте из сетевого репозитория пакет **nano**. Пересоберите пакет таким образом, чтобы после его установки менеджером пакетов, появлялась возможность запустить редактор **nano** из любого каталога, введя команду **newnano**. 
3. Предъявите преподавателю изменения в системе и файл с описанием использованных команд. 
